<html>
	<head>
        <title>Send A Card</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="style/themes/theme.css">
		<link rel="stylesheet" href="style/themes/snowflakes.css">
		<link rel="stylesheet" href="style/themes/waves.css">
        <link rel="stylesheet" href="style/themes/balloons.css">

        <link rel="stylesheet" href="style/letter.css">
        <link rel="stylesheet" href="style/input.css">
        <link rel="stylesheet" href="style/wysiwyg.css">
    </head>
    <body>
		<div class="theme snowfall">
            <div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
                <div class="snowflake">❄</div>
            </div>
        </div>
        <div class="theme waves">
			<div class="wave"></div>
			<div class="wave"></div>
			<div class="wave"></div>
		</div>
        <div class="theme balloons">
            <div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
                <div class="balloon"></div>
            </div>
        </div>

        <div class="xcenter">
			<div id="envelope" class="xcenter envelope closed">
				<img class="front" src="style/letter.back.svg">
				<p id="letter-small" class="content"></p>
				<img class="front" src="style/letter.front.svg">
			</div>
		</div>

        <div>
            <h1>Settings</h1>
            <form>
                <fieldset>
                    <legend>Theme</legend>
                    <label for="opt-salutation">Salutation</label>
                    <input type="text" id="opt-salutation" placeholder="Salutation Text"/>
                    <label for="opt-background">Background</label>
                    <select id="opt-background" onchange="change_background(event)">
                        <option>None</option>
                        <option value="snowfall">Snowing</option>
                        <option value="waves">Waves</option>
                        <option value="balloons">Balloons</option>
                    </select>
                    <label>Letter Colour <small>(Light colours tend to work the best)</small></label>
                    <input type="color" id="opt-letter-colour" value="#E0C9A6" onchange="change_letter_colour(event)"/>
                    <label>Letter Border</label>
                    <select id="opt-letter-border">
                        <option value="none">None</option>
                        <option value="4px solid gray">Solid</option>
                        <option value="4px dotted gray">Dotted</option>
                        <option value="4px dashed gray">Dashed</option>
                    </select>
                </fieldset>
                <fieldset>
                    <legend>Content</legend>
                    <!--WYSIWYG editor-->
                    <div id="editor" class="editor">
                        <header>
                            <button type="button" title="Bold" data-action="bold" data-value="" onclick="wysiwyg.action(this, event)"><b>B</b></button>
                            <button type="button" title="Underline" data-action="underline" data-value="" onclick="wysiwyg.action(this, event)"><u>U</u></button>
                            <button type="button" title="Italicize" data-action="italic" data-value="" onclick="wysiwyg.action(this, event)"><i>I</i></button>
                            <button type="button" title="Strikethrough" data-action="strikeThrough" data-value=""
                                onclick="wysiwyg.action(this, event)"><strike>S</strike></button>
                            <div class="dropdown">
                                <button type="button" title="Font Colour"><span class="box" style="background-color: #FF0000"></span></button>
                                <table class="dropdown-content">
                                    <tr>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="FFFFFF"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #FFFFFF"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="FF0000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #FF0000"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="00FF00"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #00FF00"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="0000FF"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #0000FF"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="FFFF00"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #FFFF00"></span></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="d9d9d9"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #d9d9d9"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="d90000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #d90000"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="00d900"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #00d900"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="0000d9"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #0000d9"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="cccc00"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #cccc00"></span></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="a6a6a6"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #a6a6a6"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="a60000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #a60000"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="00a600"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #00a600"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="0000a6"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #0000a6"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="999900"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #999900"></span></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="737373"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #737373"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="730000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #730000"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="007300"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #007300"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="000073"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #000073"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="666600"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #666600"></span></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="404040"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #404040"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="400000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #400000"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="004000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #004000"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="000040"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #000040"></span></button>
                                        </td>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="333300"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #333300"></span></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button type="button" data-action="foreColor" data-value="000000"
                                                onclick="wysiwyg.action(this, event)"><span class="box"
                                                    style="background-color: #000000"></span></button>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            |
                            <div class="dropdown">
                                <button title="Justification" type="button">
                                    <img src="style/justify.svg">
                                </button>
                                <div class="dropdown-content">
                                    <button title="Justify Left" type="button" data-action="justifyLeft" data-value="" onclick="wysiwyg.action(this, event)">
                                        <img src="style/justify.left.svg">
                                    </button>
                                    <button title="Justify Center" type="button" data-action="justifyCenter" data-value="" onclick="wysiwyg.action(this, event)">
                                        <img src="style/justify.center.svg">
                                    </button>
                                    <button title="Justify Right" type="button" data-action="justifyRight" data-value="" onclick="wysiwyg.action(this, event)">
                                        <img src="style/justify.right.svg">
                                    </button>
                                </div>
                            </div>
                    
                            <div class="dropdown">
                                <button title="Headings" type="button">H</button>
                                <div class="dropdown-content">
                                    <button type="button" data-action="insertHTML" data-value="<h1>Heading</h1>"
                                        onclick="wysiwyg.action(this, event)">H<sub>1</sub>&nbsp;Heading</button>
                                    <button type="button" data-action="insertHTML" data-value="<h2>Subheading</h2>"
                                        onclick="wysiwyg.action(this, event)">H<sub>2</sub>&nbsp;Subheading</button>
                                    <button type="button" data-action="insertHTML" data-value="<h3>Section</h3>"
                                        onclick="wysiwyg.action(this, event)">H<sub>3</sub>&nbsp;Section&nbsp;Heading</button>
                                </div>
                            </div>
                            <button type="button" title="Insert Ordered List" data-action="insertOrderedList" data-value="" onclick="wysiwyg.action(this, event)">
                                <img src="style/ol.svg">
                            </button>
                            <button type="button" title="Insert Unordered List" data-action="insertUnorderedList" data-value="" onclick="wysiwyg.action(this, event)">
                                <img src="style/ul.svg">
                            </button>
                            <div class="dropdown">
                                <button title="Image" type="button"><img src="style/image.svg"></button>
                                <div class="dropdown-content" style="width: 200px">
                                    <input type="file" id="opt-image-upload" onchange="wysiwyg.upload_image(event)" accept="image/*" capture="environment"/>
                                </div>
                            </div>
                            <button type="button" title="Insert Horizontal Line" data-action="insertHorizontalRule" data-value="" onclick="wysiwyg.action(this, event)">-</button>
                            <button type="button" title="Clear Formatting" data-action="removeFormat" data-value=""
                                onclick="wysiwyg.action(this, event)"><strike>CLR</strike></button>
                        </header>
                    
                        <div id="editor-content" class="content" contenteditable>
                            <h1>Happy Birthday!</h1>
                    
                            <p>
                                Dear [Name],
                            </p>
                    
                            <p>
                                On your special day, I just want to remind you of how amazing you are and how much you mean to all of us.
                                Your kindness, warmth, and sense of humor light up every room you walk into, and today is all about
                                celebrating you.
                            </p>
                    
                            <p>
                                I hope this year brings you endless happiness, new adventures, and memories that will last a lifetime. May
                                all your dreams come true.
                            </p>
                    
                            <p>
                                Enjoy every moment of today, and here's to many more birthdays filled with love and joy!
                            </p>
                    
                            <p>
                                Cheers to you,<br>
                                [Your Name]
                            </p>
                        </div>
                    </div>
                    
                    <!--/WYSIWYG editor-->
                </fieldset>
            </form>
        </div>

        <div style="text-align: center; padding: 16px;">
            <button type="button" class="accept" onclick="copy_dumb_link()">Copy Link URL</button>
            <button type="button" class="accept" onclick="copy_smart_link()">Copy Link for Outlook</button>
        </div>

        <script src="src/envelope.js"></script>
        <script src="src/theme.js"></script>
        <script src="src/wysiwyg.js"></script>
        <script>
function change_background(e) {
    var theme_name = e.target.value;
    set_background(theme_name);
}

function change_letter_colour(e) {
    var colour = e.target.value;
    set_letter_color(colour);
}

async function make_link() {
    var base_url = window.location.origin;
    var path = window.location.pathname.split( '/' ); path.pop();
    base_url = base_url + path.join('/') + "/open.html";

    return  base_url 
            + "?" + "bg=" + encodeURIComponent(document.getElementById("opt-background").value)
            + "&" + "lcolour=" + encodeURIComponent(document.getElementById("opt-letter-colour").value)
            + "&" + "lborder=" + encodeURIComponent(document.getElementById("opt-letter-border").value)
            + "&" + "title=" + encodeURIComponent(document.getElementById("opt-salutation").value) 
            + "&" + "content=" + encodeURIComponent(await wysiwyg.get_compressed_url_safe_html()) 
            ;
}

async function copy_dumb_link() {
    var url = await make_link();

    const clipboardItem = new ClipboardItem({
        "text/plain": new Blob(
            [url],
            { type: "text/plain" }
        )
    });

    navigator.clipboard.write([clipboardItem]);

    alert("Link copied to clipboard.");
}

async function copy_smart_link() {
    var name = "open your card";
    var url = await make_link();

    var elem = document.createElement("a");
    elem.href = url;
    elem.innerText = name;

    const clipboardItem = new ClipboardItem({
        "text/plain": new Blob(
            [elem.innerText],
            { type: "text/plain" }
        ),
        "text/html": new Blob(
            [elem.outerHTML],
            { type: "text/html" }
        ),
    });

    navigator.clipboard.write([clipboardItem]);

    alert("Link copied to clipboard.");
}
        </script>
    </body>
</html>